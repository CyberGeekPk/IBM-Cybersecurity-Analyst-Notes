# Module 4 - Injection Vulnerabilities
In this module, you will gain a comprehensive understanding of injection vulnerabilities, a critical area in database security. You will learn about injection flaws, setting the stage for a deeper understanding of various types of injections. Further, you will explore OS command injection and learn about different techniques and their implications for system security. You will also be introduced to SQL injection, its mechanisms, and impacts. Additionally, you will gain insight into other types of injection vulnerabilities, broadening your understanding of potential threats. You will also review additional resources that provide detailed guidelines and standards for understanding, identifying, and mitigating injection vulnerabilities. You will have the hands-on opportunity to perform SQL injection testing to evaluate the security of an application.

# DEEP DIVE INJECTION VULNERABILITIES

## Introduction to Injection Flaws 
Injection flaws allow attackers to relay malicious code through the vulnerable application to another system. You also learned that they have been consistently rated as the most dangerous type of vulnerability across lists like OS Top 10 and SANS Top 25. Finally, you learned that injection vulnerabilities have been responsible for attacks like the Equifax Hack and the Hack of TalkTalk.

## OS Command Injection: Part 1
OS command injection is the abuse of vulnerable application functionality that causes the execution of OS commands specified by the attacker. These vulnerabilities can be caused by a lack of input sanitization and the unsafe execution of OS commands. Recommendations to prevent OS command injections include using the functionality built into the language or third-party libraries and running OS commands at least privilege possible.

## OS Command Injection: Part 2
Third recommendation to prevent OS command injection is to not run commands through shell interpreters. When you run the command directly without passing it to the shell interpreter, it makes the whole set of shell syntaxes invalid. You must scrutinize how to operate on the user's input so that a malicious command is not executed. The fourth recommendation to prevent OS command injections is to use explicit paths when running executables. To protect against it, you should reference all the executables you run by their full path. This way, there is no ambiguity and the right executable will be loaded. Recommendation 4 also applies to DLL hijacking and shared libraries. Explicit references will help you avoid DL hijacking.

## OS Command Injection: Part 3
The fifth recommendation is to use proper functionality when running OS system commands. When you run OS commands, it is a good practice to evaluate the available functions and use the safest functionality. The sixth recommendation is, if possible, you should not let user input reach the place where you execute the command unchanged. You can deal with different entities that the OS command will be operating on in the UI as symbolic IDs. The seventh recommendation is that you should carefully sanitize user input with strict whitelists and not blacklists. A blacklist is a list of inputs that are known to be dangerous. In your logic, if the past parameter does not match any of the harmful parameters on this list, it will pass. Whitelists are tight and controlled lists of what inputs are allowed and what should be rejected. This way, you know that you're dealing with a fairly small entity.

## SQL Injection: Part 1
SQL injection is an attack that exploits security flaws to run unauthorized SQL commands. It can lead to access, modification, or deletion of database information and bypass security protocols. You also learned that the major risks include bypassing authentication, data exfiltration, executing OS commands, and causing vandalism or DOS attacks. Finally, you explored common types of SQL injections. Error-based, which uses error messages to tailor commands. Union-based, which combines query results to exfiltrate data. Blind injection, which infers data through Boolean or time-based methods. Out-of-band injection triggers external requests for data exfiltration.

## SQL Injection: Part 2
Preventing SQL injection is crucial for maintaining the security of your database and application and involves a few key methods. Using prepared statements handle SQL queries securely, sanitizing all user input involves cleaning and validating input data before processing it. Restricting native database error exposure prevents attackers from getting insights about the back-end operations. Limiting database user permissions is a good practice to prevent command injection attacks. Using stored procedures involve compiling and storing procedures in the database engine, making them less vulnerable to SQL injection attacks. Finally, you learned that object-relational mapping libraries help mitigate SQL injection by mapping database structures to in-memory objects.

## Database Injection Vulnerabilities 
Database injection vulnerabilities can occur when an application fails to properly sanitize user inputs, allowing attackers to inject malicious code into database queries. Some common types of vulnerabilities are SQL injection, NoSQL injection, LDAP injection, and XML injection. Database injection attacks can have severe consequences, including data theft, data corruption, system compromise, and reputational damage. Some strategies to secure data against database injection vulnerabilities include input validation, parameterized queries, stored procedures, escaping special characters, and WAFs. Additionally, certain best practices enable secure coding, such as the principle of least privilege, regular security audits, secure configuration, and awareness and training.

## Other Types of Injections
NoSQL databases can have expressions or little script pieces open to abuse. If you allow user input to reach the functionality unchecked, it becomes vulnerable to injections. XPath is another popular technology that is used to search for login credentials in XML documents. If not done carefully, it can be attacked by injections. LDAP also has syntax, allowing expressions and little scripts that can be abused. Certain general recommendations to safeguard against injections include using functionality with reduced scope, executing with least privilege, and sanitizing inputs with whitelists.
